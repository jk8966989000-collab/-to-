<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Merry Christmas</title>

<link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">

<style>
html,body{
  margin:0;
  padding:0;
  overflow:hidden;
  background:linear-gradient(#07192f,#0e2a47);
}
canvas{display:block;}
</style>
</head>

<body>
<canvas id="c"></canvas>

<script>
const canvas = document.getElementById("c");
const ctx = canvas.getContext("2d");

function resize(){
  canvas.width = innerWidth;
  canvas.height = innerHeight;
}
resize();
addEventListener("resize",resize);

let fontsReady=false;
document.fonts.ready.then(()=>fontsReady=true);

let frame=0;
let stage=0;
let flash=0;

/* 雪 */
const snow=Array.from({length:120},()=>({
  x:Math.random()*canvas.width,
  y:Math.random()*canvas.height,
  r:Math.random()*2+1,
  s:Math.random()*0.6+0.4
}));

/* 煙火 */
const fireworks=[];

/* 中文 */
const lines=[
  "九千：",
  "這是我和妳一起過的",
  "第一個聖誕節，",
  "希望我們的友誼",
  "長長久久，",
  "未來能給彼此更多",
  "有趣的驚喜♡",
  "",
  "to.羊羊（2025/12/25）"
];
let lineIndex=0;
let charIndex=0;

/* 點擊 */
canvas.onclick=()=>{
  if(stage===0){
    stage=1;
    flash=60;
    setTimeout(()=>stage=2,1200);
    setTimeout(()=>stage=3,2500);
    setTimeout(()=>stage=4,3500);
    setTimeout(()=>stage=5,4500);
    setTimeout(()=>stage=6,5500);
    return;
  }
  if(stage===6){
    stage=7;
  }
};

/* 禮物盒 */
function drawGift(){
  if(stage!==0) return;
  const s=Math.min(canvas.width,canvas.height)*0.5;
  const x=canvas.width/2-s/2;
  const y=canvas.height/2-s/2;
  ctx.fillStyle="#c62828";
  ctx.fillRect(x,y,s,s);
  ctx.fillStyle="#ffd54f";
  ctx.fillRect(x+s/2-20,y,40,s);
  ctx.fillRect(x,y+s/2-20,s,40);
}

/* ✅ 完整 Q 版兔子 */
function drawBunny(){
  if(stage<2||stage>3) return;
  const x=canvas.width/2;
  const y=canvas.height/2+60;
  const r=Math.min(canvas.width,canvas.height)*0.22;

  // 身體
  ctx.fillStyle="#fff";
  ctx.beginPath();
  ctx.arc(x,y,r,0,Math.PI*2);
  ctx.fill();

  // 耳朵
  ctx.beginPath();
  ctx.ellipse(x-r/2,y-r*1.3,r/4,r*0.9,0,0,Math.PI*2);
  ctx.ellipse(x+r/2,y-r*1.3,r/4,r*0.9,0,0,Math.PI*2);
  ctx.fill();

  // 眼睛
  ctx.fillStyle="#333";
  ctx.beginPath();
  ctx.arc(x-r/4,y-r/8,6,0,Math.PI*2);
  ctx.arc(x+r/4,y-r/8,6,0,Math.PI*2);
  ctx.fill();

  // 腮紅
  ctx.fillStyle="rgba(255,180,180,0.8)";
  ctx.beginPath();
  ctx.arc(x-r/2.5,y+r/8,8,0,Math.PI*2);
  ctx.arc(x+r/2.5,y+r/8,8,0,Math.PI*2);
  ctx.fill();
}

/* 英文 */
function drawTitle(){
  if(stage<4||!fontsReady) return;
  ctx.font="96px 'Great Vibes'";
  ctx.textAlign="center";
  ctx.fillStyle="rgba(255,215,160,0.95)";
  ctx.shadowColor="rgba(255,215,160,0.8)";
  ctx.shadowBlur=15;
  ctx.fillText("Merry Christmas",canvas.width/2,140);
  ctx.shadowBlur=0;
}

/* 點擊提示（兩次） */
function drawClickHint(){
  if(stage!==0 && stage!==6) return;
  ctx.strokeStyle="rgba(255,255,255,0.8)";
  ctx.lineWidth=4;
  const x=stage===0
    ? canvas.width/2+canvas.width*0.15
    : canvas.width/2;
  const y=stage===0
    ?
