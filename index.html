<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Merry Christmas</title>

<link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">

<style>
  html, body {
    margin: 0;
    padding: 0;
    overflow: hidden;
    background: linear-gradient(#0b1d33, #102a44);
  }
  canvas {
    display: block;
  }
</style>
</head>

<body>
<canvas id="c"></canvas>

<script>
const canvas = document.getElementById("c");
const ctx = canvas.getContext("2d");

function resize() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
resize();
window.addEventListener("resize", resize);

// ‚ùÑÔ∏è Èõ™Ëä±
const snowflakes = Array.from({ length: 120 }, () => ({
  x: Math.random() * canvas.width,
  y: Math.random() * canvas.height,
  r: Math.random() * 2 + 1,
  s: Math.random() * 0.6 + 0.4
}));

// ‚ú® ÈáëÂÖâÁ≤íÂ≠ê
const sparkles = [];

// ÁãÄÊÖã
let opened = false;
let showBunny = false;
let flashTime = 0;

// üéÅ ÈªûÊìä
canvas.onclick = () => {
  if (opened) return;
  opened = true;

  for (let i = 0; i < 220; i++) {
    sparkles.push({
      x: canvas.width / 2,
      y: canvas.height / 2,
      vx: Math.cos(Math.random() * Math.PI * 2) * (3 + Math.random() * 6),
      vy: Math.sin(Math.random() * Math.PI * 2) * (3 + Math.random() * 6),
      life: 60,
      size: 2 + Math.random() * 3
    });
  }

  flashTime = 60;
  setTimeout(() => showBunny = true, 1000);
};

// üå≤ ËÅñË™ïÊ®π
function drawTree(x, y, s) {
  ctx.save();
  ctx.translate(x, y);
  ctx.scale(s, s);

  ctx.fillStyle = "#1b5e3c";
  ctx.beginPath();
  ctx.moveTo(0, -60);
  ctx.lineTo(-40, 20);
  ctx.lineTo(40, 20);
  ctx.closePath();
  ctx.fill();

  ctx.fillStyle = "#7b4a12";
  ctx.fillRect(-6, 20, 12, 20);

  ctx.restore();
}

// üéÅ Á¶ÆÁâ©Áõí
function drawGift() {
  if (opened) return;

  const x = canvas.width / 2;
  const y = canvas.height / 2;

  ctx.fillStyle = "#c62828";
  ctx.fillRect(x - 50, y - 40, 100, 80);

  ctx.fillStyle = "#fdd835";
  ctx.fillRect(x - 8, y - 40, 16, 80);
  ctx.fillRect(x - 50, y - 8, 100, 16);
}

// ‚ú® ÈáëÂÖâÁ≤íÂ≠ê
function drawSparkles() {
  sparkles.forEach(p => {
    p.x += p.vx;
    p.y += p.vy;
    p.life--;

    ctx.fillStyle = `rgba(255,215,120,${p.life / 60})`;
    ctx.beginPath();
    ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
    ctx.fill();
  });

  for (let i = sparkles.length - 1; i >= 0; i--) {
    if (sparkles[i].life <= 0) sparkles.splice(i, 1);
  }
}

// üåü ÈáëÂÖâË¶ÜËìã
function drawFlash() {
  if (flashTime <= 0) return;
  flashTime--;

  const g = ctx.createRadialGradient(
    canvas.width / 2, canvas.height / 2, 0,
    canvas.width / 2, canvas.height / 2, canvas.width
  );

  g.addColorStop(0, `rgba(255,230,160,${flashTime / 60})`);
  g.addColorStop(1, "rgba(255,230,160,0)");

  ctx.fillStyle = g;
  ctx.fillRect(0, 0, canvas.width, canvas.height);
}

// üê∞ ‰πñ‰πñÂÖîÂ≠ê
function drawBunny() {
  if (!showBunny) return;

  const x = canvas.width / 2;
  const y = canvas.height / 2 + 40;

  ctx.fillStyle = "#fff";
  ctx.beginPath();
  ctx.arc(x, y, 50, 0, Math.PI * 2);
  ctx.fill();

  ctx.beginPath();
  ctx.ellipse(x - 20, y - 70, 12, 30, 0, 0, Math.PI * 2);
  ctx.ellipse(x + 20, y - 70, 12, 30, 0, 0, Math.PI * 2);
  ctx.fill();

  ctx.fillStyle = "#ffb6c1";
  ctx.beginPath();
  ctx.arc(x - 12, y - 5, 4, 0, Math.PI * 2);
  ctx.arc(x + 12, y - 5, 4, 0, Math.PI * 2);
  ctx.fill();

  ctx.strokeStyle = "#999";
  ctx.beginPath();
  ctx.moveTo(x - 6, y + 6);
  ctx.lineTo(x + 6, y + 6);
  ctx.stroke();
}

// ‚úçÔ∏è ÈáëÁ≤âÂ≠ó
function drawText() {
  if (!showBunny) return;

  const t = Date.now() * 0.004;
  const shimmer = 0.7 + Math.sin(t) * 0.3;

  ctx.font = "56px 'Great Vibes'";
  ctx.textAlign = "center";
  ctx.fillStyle = `rgba(255,215,150,${shimmer})`;
  ctx.fillText("Merry Christmas", canvas.width / 2, 130);
}

// ‚ùÑÔ∏è Èõ™
function drawSnow() {
  ctx.fillStyle = "#fff";
  snowflakes.forEach(f => {
    f.y += f.s;
    if (f.y > canvas.height) f.y = -10;
    ctx.beginPath();
    ctx.arc(f.x, f.y, f.r, 0, Math.PI * 2);
    ctx.fill();
  });
}

// üîÅ ‰∏ªËø¥Âúà
function loop() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  drawSnow();

  drawTree(100, canvas.height - 120, 1.2);
  drawTree(canvas.width - 120, canvas.height - 120, 1.2);

  drawGift();
  drawSparkles();
  drawFlash();
  drawBunny();
  drawText();

  requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>
